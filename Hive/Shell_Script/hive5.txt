select job_title,year from(select rank() over(partition by year order by ad desc)as ad1,job_title,year from(select count(job_title)as ad,job_title,year from h1b group by job_title,year)a)b where ad1<=10;
